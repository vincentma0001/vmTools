/////////////////////////////////////////////////////////////////////////////////////////
//
// File name    : CErrBase.h
// Version      : 0.0.0.0
// Author       : v.m.
// Brief        : 此文件定义了CError类为错误处理提供基类,用于存储错误代码与错误信息
// Create time  : 2019/12/20 08:33:15
// Modify time  : 2019/12/20 08:33:15
// Note         :
//
/////////////////////////////////////////////////////////////////////////////////////////
//
// Copyright : this file is copyright by v.m.'s tools lib
//
/////////////////////////////////////////////////////////////////////////////////////////
// compile macro definition
#if defined (_MSC_VER) && (_MSC_VER >= 1300)
#pragma once
#endif

#ifndef __CERRBASE_H__
#define __CERRBASE_H__

/////////////////////////////////////////////////////////////////////////////////////////
// Files include : 

#ifndef   __VM_CFG_H__
#	error this file need #include <vmCfg.h>
#endif // __VM_CFG_H__

/////////////////////////////////////////////////////////////////////////////////////////
// using namespace
namespace vm{

/////////////////////////////////////////////////////////////////////////////////////////
//
// class CError : 此类封装了错误系统错误信息
//
/////////////////////////////////////////////////////////////////////////////////////////
class DLL_API CErrBase
{
/////////////////////////////////////////////////////////////////////////////////////////
// Macro defines :
#ifndef   _V_ERR_MAX_BUF_
#   define _V_ERR_MAX_BUF_ 1024
#endif // _V_ERR_MAX_BUF_

/////////////////////////////////////////////////////////////////////////////////////////
// Construct && Destruct
public:
    // Construct define
    explicit CErrBase();
    explicit CErrBase(const unsigned long culErrCode);
    // Destruct define
    virtual ~CErrBase();
    
public:
    // Copy define 
    CErrBase(const CErrBase& obj);
    // Assignment define
    CErrBase& operator = ( const CErrBase& obj );
    
/////////////////////////////////////////////////////////////////////////////////////////
// members
public:
    // 错误代码
    unsigned long       mulErrCode;
    tchar               mszBuf[ _V_ERR_MAX_BUF_ ];

/////////////////////////////////////////////////////////////////////////////////////////
// Functions :
public:
    // Output error code 
    unsigned long    toErrCode();
    // Output error message
    tchar*           toErrStr();
    // Format error message
    tchar*           Fmt(const tchar* const cpFmt = "%EC:%EM" );

protected:
    // 获取错误代码信息
    virtual tchar*   GetErrStr( tchar* pBufAddr, const size_t csztBufSzie, size_t& sztStrLen );

}; // End of class CError
/////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////
} // End of namespace vm
/////////////////////////////////////////////////////////////////////////////////////////
#endif // __CERRBASE_H__
/////////////////////////////////////////////////////////////////////////////////////////
// usage :
/*

//*/
/////////////////////////////////////////////////////////////////////////////////////////
// End of file CErrBase.h
/////////////////////////////////////////////////////////////////////////////////////////