/////////////////////////////////////////////////////////////////////////////////////////
//
// File name 	: CDLoader.h
// Version 		: 1.0.0.0
// Brief 		: 
// Author 		: v.m.
// Create time 	: 22/2/2016 9:47:40
// Modify time 	: 22/2/2016 9:47:40
// Note 		:
//
/////////////////////////////////////////////////////////////////////////////////////////
//
// Copyright : this file is copyright by Julong Co.LTD
//
/////////////////////////////////////////////////////////////////////////////////////////
// compile macro definition
#if defined (_MSC_VER) && (_MSC_VER >= 1300)
#pragma once
#endif

#ifndef __CDLOADER_H__
#define __CDLOADER_H__
/////////////////////////////////////////////////////////////////////////////////////////
// include 
#include <windows.h>
#include <string>

/////////////////////////////////////////////////////////////////////////////////////////
class CModuleLoader
{
/////////////////////////////////////////////////////////////////////////////////////////
// data members :
private:
    HMODULE         mHandle;                            // 模块指针
    DWORD           mdwErrCode;                         // 错误代码
    std::string     mstrErrDes;                         // 错误描述

/////////////////////////////////////////////////////////////////////////////////////////
// Construct & Destruct :
public:
    CModuleLoader( const char* cszDLLName );		    // Construct define
    virtual ~CModuleLoader();                           // Destruct define

public:
    void Load( const char* cszDllName );                // 加载模块
    void Free( void );                                  // 释放模块

public:
    void* GetAddr( const char* cszName );               // 获取函数

public:
    const char*     GetErrDes   ( void );               // 获取错误描述;
    unsigned long   GetErrCode  ( void );               // 获取错误代码;

}; // End of class CDLoader
/////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////
#endif // __CDLOADER_H__
/////////////////////////////////////////////////////////////////////////////////////////
// End of file CDLoader.h
/////////////////////////////////////////////////////////////////////////////////////////
