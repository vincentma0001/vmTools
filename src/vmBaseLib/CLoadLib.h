/////////////////////////////////////////////////////////////////////////////////////////
//
// File name 	: CLoadLib.h
// Version 		: 1.0.0.0
// Brief 		: 
// Author 		: v.m.
// Create time 	: 19/7/2016 16:06:49
// Modify time 	: 19/7/2016 16:06:49
// Note 		:
//
/////////////////////////////////////////////////////////////////////////////////////////
//
// Copyright : this file is copyright by Julong Co.LTD
//
/////////////////////////////////////////////////////////////////////////////////////////
// compile macro definition
#if defined (_MSC_VER) && (_MSC_VER >= 1300)
#pragma once
#endif

#ifndef __CLOADLIB_H__
#define __CLOADLIB_H__

/////////////////////////////////////////////////////////////////////////////////////////
// include file
#include <Windows.h>
#include <string>
#include "CWinError.h"

 /////////////////////////////////////////////////////////////////////////////////////////
 //
 // class define : CLoadLib
 //        Notes : ## add class brief here #
 //
 /////////////////////////////////////////////////////////////////////////////////////////
 class CLoadLib
 {
 /////////////////////////////////////////////////////////////////////////////////////////
 // data members :
 private:
     HMODULE mhModule;
     int miLastError;
     std::string mstrLastError;

 /////////////////////////////////////////////////////////////////////////////////////////
 // Construct & Destruct :
 public:
 	CLoadLib();;		            // Construct define
 	virtual ~CLoadLib();;          // Destruct define

 /////////////////////////////////////////////////////////////////////////////////////////
 // functions :
 public:
     int GetErrorCode();
     const char* GetErrorInfo();

     bool Load( const char* szDllName );
     FARPROC GetFunc(const char* szFuncName);
 
 }; // End of class CLoadLib
 /////////////////////////////////////////////////////////////////////////////////////////


/////////////////////////////////////////////////////////////////////////////////////////
#endif // __CLOADLIB_H__
/////////////////////////////////////////////////////////////////////////////////////////
// End of file CLoadLib.h
/////////////////////////////////////////////////////////////////////////////////////////
